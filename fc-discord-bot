import feedparser
import requests
import os

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† (Ø³Ù†Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¬ÙŠØª Ù‡Ø§Ø¨)
DISCORD_WEBHOOK_URL = os.getenv('DISCORD_WEBHOOK')

# Ø±Ø§Ø¨Ø· Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø³Ø§Ø¨ FUTBIN
RSS_URL = 'https://rssbridge.org/bridge01/?action=display&bridge=TwitterBridge&context=By+screen+name&u=FUTBIN&format=Atom'

def send_to_discord(content):
    if not DISCORD_WEBHOOK_URL:
        print("Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ Webhook")
        return
    data = {"content": content}
    requests.post(DISCORD_WEBHOOK_URL, json=data)

def run_bot():
    print("Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯...")
    feed = feedparser.parse(RSS_URL)
    
    if feed.entries:
        # Ù†Ø£Ø®Ø° Ø¢Ø®Ø± Ù…Ù†Ø´ÙˆØ± ÙÙ‚Ø·
        latest_entry = feed.entries[0]
        title = latest_entry.title
        link = latest_entry.link
        
        # Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        message = f"ğŸ“¢ **Ù…Ø­ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯ Ù†Ø²Ù„ ÙÙŠ Ø§Ù„ØªÙ…Øª ØªÙŠÙ…!**\n\nğŸ”— {link}"
        
        # Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
        send_to_discord(message)
        print(f"ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: {title}")

if __name__ == "__main__":
    run_bot()
